2025-10-27 18:51:31,752 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-27 18:51:33,663 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 12:49:00,957 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 12:49:02,434 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 13:01:06,548 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 13:01:06,549 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 13:02:40,498 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 13:02:40,499 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 13:05:01,093 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 13:05:01,094 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 15:58:17,222 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 15:58:17,230 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 87, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 15:58:17,232 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 87, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:45:20,545 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:45:20,556 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 87, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:45:20,558 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 87, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 42, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:46:24,851 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:46:24,852 | INFO | genai_sql_agent | Falling back to legacy OpenAI SDK (<1.0) (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable)
2025-10-28 16:46:24,854 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:46:29,136 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 80, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:46:29,139 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 128, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 80, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:46:29,142 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 128, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 80, in generate_sql_openai
    resp = openai.Completion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.Completion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:47:46,671 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:47:46,671 | INFO | genai_sql_agent | Using legacy OpenAI SDK (<1.0) with ChatCompletion.create (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable)
2025-10-28 16:47:46,672 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:47:51,086 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:47:51,093 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 148, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:47:51,098 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 148, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:50:02,467 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:50:02,469 | ERROR | genai_sql_agent | OpenAI initialization failed: No module named 'openai'
Traceback (most recent call last):
  File "c:\Study\SQL_Generation_LLM\langchain_agent.py", line 14, in <module>
    from openai import OpenAI
ModuleNotFoundError: No module named 'openai'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Study\SQL_Generation_LLM\langchain_agent.py", line 20, in <module>
    import openai  # legacy (<1.0) module
    ^^^^^^^^^^^^^
ModuleNotFoundError: No module named 'openai'
2025-10-28 16:50:02,472 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain')
2025-10-28 16:50:26,718 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:50:27,732 | INFO | genai_sql_agent | Using legacy OpenAI SDK (<1.0) with ChatCompletion.create (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable)
2025-10-28 16:50:27,735 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:50:39,086 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:50:39,098 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 148, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:50:39,106 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 148, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 104, in generate_sql_openai
    raise last_err if last_err else RuntimeError("Legacy model selection failed")
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 88, in generate_sql_openai
    resp = openai.ChatCompletion.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\lib\_old_api.py", line 39, in __call__
    raise APIRemovedInV1(symbol=self._symbol)
openai.lib._old_api.APIRemovedInV1: 

You tried to access openai.ChatCompletion, but this is no longer supported in openai>=1.0.0 - see the README at https://github.com/openai/openai-python for the API.

You can run `openai migrate` to automatically upgrade your codebase to use the 1.0.0 interface. 

Alternatively, you can pin your installation to the old version, e.g. `pip install openai==0.28`

A detailed migration guide is available here: https://github.com/openai/openai-python/discussions/742

2025-10-28 16:51:39,847 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:51:39,847 | ERROR | genai_sql_agent | OpenAI import failure: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 19, in <module>
    _openai_client = openai.OpenAI(api_key=OPENAI_KEY)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_client.py", line 137, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
2025-10-28 16:51:39,851 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:51:47,389 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 117, in generate_sql_openai
    raise RuntimeError(
RuntimeError: OpenAI client unavailable though version is 2.6.1. Check installation or API key.
2025-10-28 16:51:47,391 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 163, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 117, in generate_sql_openai
    raise RuntimeError(
RuntimeError: OpenAI client unavailable though version is 2.6.1. Check installation or API key.
2025-10-28 16:51:47,397 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 239, in <module>
    sql_raw = generate_sql(st.session_state.nl_query, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 163, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 117, in generate_sql_openai
    raise RuntimeError(
RuntimeError: OpenAI client unavailable though version is 2.6.1. Check installation or API key.
2025-10-28 16:53:18,069 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:53:19,530 | WARNING | genai_sql_agent | Failed creating new OpenAI client (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable); will attempt legacy fallback.
2025-10-28 16:53:19,533 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:54:09,235 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:54:10,349 | WARNING | genai_sql_agent | Failed creating new OpenAI client (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable); will attempt legacy fallback.
2025-10-28 16:54:10,351 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:55:38,059 | ERROR | genai_sql_agent | OPENAI_API_KEY not set in environment
2025-10-28 16:55:38,794 | WARNING | genai_sql_agent | Failed creating new OpenAI client (The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable); will attempt legacy fallback.
2025-10-28 16:55:38,797 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:58:30,466 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-28 16:58:30,470 | WARNING | genai_sql_agent | LangChain not available or incompatible; will use direct OpenAI prompts. (No module named 'langchain.llms')
2025-10-28 16:59:46,220 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-28 16:59:46,222 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-28 17:00:07,861 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-28 17:00:07,863 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(purchase_amount) AS lifetime_value  FROM transactions  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-28 17:00:07,863 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 17:00:11,404 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 17:00:12,411 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(purchase_amount) AS lifetime_value  FROM transactions  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-28 17:00:12,412 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 17:00:13,603 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 17:00:15,611 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(purchase_amount) AS lifetime_value  FROM transactions  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-28 17:00:15,611 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 17:00:16,887 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 18:03:52,405 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-28 18:03:52,412 | INFO | genai_sql_agent | Executing SQL (start): SELECT COUNT(*) AS transaction_count FROM transactions
2025-10-28 18:03:52,413 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 18:03:53,643 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 18:03:54,649 | INFO | genai_sql_agent | Executing SQL (start): SELECT COUNT(*) AS transaction_count FROM transactions
2025-10-28 18:03:54,649 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 18:03:55,763 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 18:03:57,766 | INFO | genai_sql_agent | Executing SQL (start): SELECT COUNT(*) AS transaction_count FROM transactions
2025-10-28 18:03:57,766 | INFO | genai_sql_agent | Opening Snowflake connection user=readonly_user db=ANALYTICS_DB schema=PUBLIC
2025-10-28 18:03:58,836 | ERROR | genai_sql_agent | Snowflake query failed: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request
2025-10-28 18:03:58,841 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 38, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 21, in get_connection
    conn = snowflake.connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\__init__.py", line 66, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 654, in __init__
    self.connect(**kwargs)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1120, in connect
    self.__open_connection()
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1536, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1870, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\connection.py", line 1902, in _authenticate
    auth.authenticate(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\auth\_auth.py", line 242, in authenticate
    ret = self._rest._post_request(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 747, in _post_request
    ret = self.fetch(
          ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 866, in fetch
    ret = self._request_exec_wrapper(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1007, in _request_exec_wrapper
    raise e
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 917, in _request_exec_wrapper
    return_object = self._request_exec(
                    ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1214, in _request_exec
    raise err
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 1161, in _request_exec
    raise_failed_request_error(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\network.py", line 227, in raise_failed_request_error
    Error.errorhandler_wrapper(
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.HttpError: 290404 (08001): 404 Not Found: post your_account_region.snowflakecomputing.com:443/session/v1/login-request

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 255, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1c61627dd90 state=finished raised HttpError>]
2025-10-28 18:14:00,466 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-28 18:14:00,470 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-28 18:14:22,977 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-28 18:14:22,979 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(order_value) AS lifetime_value  FROM orders  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-28 18:14:22,980 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:14:23,983 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(order_value) AS lifetime_value  FROM orders  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-28 18:14:23,983 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:14:23,985 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 151, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x2b854ad0390 state=finished raised ValueError>]
2025-10-28 18:40:57,517 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-28 18:40:57,520 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-28 18:41:42,973 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-28 18:41:42,979 | INFO | genai_sql_agent | Executing SQL (start): SELECT COUNT(*) AS transaction_count FROM transactions
2025-10-28 18:41:42,980 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:41:43,985 | INFO | genai_sql_agent | Executing SQL (start): SELECT COUNT(*) AS transaction_count FROM transactions
2025-10-28 18:41:43,986 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:41:43,992 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 71, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x182874be8d0 state=finished raised ValueError>]
2025-10-28 18:44:49,412 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-28 18:44:49,420 | INFO | genai_sql_agent | Executing SQL (start): WITH SalesData AS (     SELECT e.name AS employee_name, d.name AS department_name, m.name AS manager_name, SUM(s.amount) AS total_sales     FROM employees e     JOIN departments d ON e.department_id = d.id     JOIN employees m ON e.manager_id = m.id     JOIN sales s ON e.id = s.employee_id     WHERE
2025-10-28 18:44:49,422 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:44:50,425 | INFO | genai_sql_agent | Executing SQL (start): WITH SalesData AS (     SELECT e.name AS employee_name, d.name AS department_name, m.name AS manager_name, SUM(s.amount) AS total_sales     FROM employees e     JOIN departments d ON e.department_id = d.id     JOIN employees m ON e.manager_id = m.id     JOIN sales s ON e.id = s.employee_id     WHERE
2025-10-28 18:44:50,425 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.
2025-10-28 18:44:50,427 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 112, in run_query
    conn = get_connection()
           ^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 64, in get_connection
    validate_snowflake_config()
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 46, in validate_snowflake_config
    raise ValueError(
ValueError: Snowflake configuration still contains placeholder values for: SNOWFLAKE_ACCOUNT, SNOWFLAKE_USER, SNOWFLAKE_PASSWORD. Please update your .env with real credentials.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 71, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x18287b3ff10 state=finished raised ValueError>]
2025-10-28 18:46:07,995 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 14:10:13,100 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 14:10:13,111 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 16:58:22,480 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 16:58:22,496 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 16:59:01,996 | WARNING | genai_sql_agent | Responses API failed (Error code: 401 - {'error': {'message': 'The OpenAI account associated with this API key has been deactivated. If you are the developer for this OpenAI app, please check your email for more information. If you are seeing this error while using another app or site, please reach out to them for more help.', 'type': 'invalid_request_error', 'param': None, 'code': 'account_deactivated'}}); attempting chat.completions fallback.
2025-10-29 16:59:02,459 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 110, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'The OpenAI account associated with this API key has been deactivated. If you are the developer for this OpenAI app, please check your email for more information. If you are seeing this error while using another app or site, please reach out to them for more help.', 'type': 'invalid_request_error', 'param': None, 'code': 'account_deactivated'}}
2025-10-29 16:59:02,491 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 177, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 110, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'The OpenAI account associated with this API key has been deactivated. If you are the developer for this OpenAI app, please check your email for more information. If you are seeing this error while using another app or site, please reach out to them for more help.', 'type': 'invalid_request_error', 'param': None, 'code': 'account_deactivated'}}
2025-10-29 16:59:02,508 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 52, in <module>
    sql_raw = generate_sql(user_q, schema_text=schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 177, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 110, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'The OpenAI account associated with this API key has been deactivated. If you are the developer for this OpenAI app, please check your email for more information. If you are seeing this error while using another app or site, please reach out to them for more help.', 'type': 'invalid_request_error', 'param': None, 'code': 'account_deactivated'}}
2025-10-29 17:15:52,269 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 17:15:52,281 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 17:16:49,365 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 17:16:49,373 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(purchase_amount) AS lifetime_value  FROM transactions  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-29 17:16:49,375 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 17:16:55,085 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
2025-10-29 17:16:56,331 | INFO | genai_sql_agent | Executing SQL (start): SELECT customer_id, SUM(purchase_amount) AS lifetime_value  FROM transactions  GROUP BY customer_id  ORDER BY lifetime_value DESC  LIMIT 10
2025-10-29 17:16:56,333 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 17:16:57,244 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
2025-10-29 17:16:57,524 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 71, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x16fa3c53950 state=finished raised RuntimeError>]
2025-10-29 19:12:57,063 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 19:12:57,072 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 19:13:17,308 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:13:17,313 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:13:17,314 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:13:19,747 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:13:20,950 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:13:20,950 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:13:21,572 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:13:21,776 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 71, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x20c632fb510 state=finished raised RuntimeError>]
2025-10-29 19:16:53,047 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:16:53,050 | INFO | genai_sql_agent | Executing SQL (start): SELECT SCHOOL_KEY,         SUM(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS ATTENDANCE_PERCENTAGE  FROM attendance  GROUP BY SCHOOL_KEY
2025-10-29 19:16:53,051 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:16:53,758 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 19:17:29,913 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:17:29,922 | INFO | genai_sql_agent | Executing SQL (start): SELECT SCHOOL_KEY,         SUM(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS ATTENDANCE_PERCENTAGE  FROM attendance  GROUP BY SCHOOL_KEY
2025-10-29 19:17:29,924 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:17:30,543 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 19:25:20,798 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 19:25:20,806 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 19:26:00,994 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:26:01,003 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:26:01,004 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:26:02,942 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:26:04,140 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:26:04,141 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:26:04,819 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:26:05,011 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 99, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1e13a3383d0 state=finished raised RuntimeError>]
2025-10-29 19:26:15,675 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:26:15,682 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:26:15,684 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:26:16,620 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:26:17,815 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 19:26:17,815 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:26:18,411 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 19:26:18,611 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 114, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 123, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 99, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1e139888ad0 state=finished raised RuntimeError>]
2025-10-29 19:28:18,713 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:28:18,715 | INFO | genai_sql_agent | Executing SQL (start): SELECT SCHOOL_KEY,         SUM(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS ATTENDANCE_PERCENTAGE  FROM attendance  GROUP BY SCHOOL_KEY
2025-10-29 19:28:18,717 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:28:19,303 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 19:32:41,472 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 19:32:41,479 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 19:33:38,606 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 19:33:38,625 | INFO | genai_sql_agent | Executing SQL (start): SELECT SCHOOL_KEY,         SUM(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS ATTENDANCE_PERCENTAGE  FROM attendance  GROUP BY SCHOOL_KEY
2025-10-29 19:33:38,628 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 19:33:40,576 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 20:45:04,069 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 20:45:04,139 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 20:45:25,439 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:45:29,648 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 20:45:39,689 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 20:45:39,696 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 20:45:39,698 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:45:40,454 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:45:42,065 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 20:45:43,271 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 20:45:43,272 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:45:44,013 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:45:45,448 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 20:45:45,656 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 99, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1a3425cf450 state=finished raised RuntimeError>]
2025-10-29 20:50:29,091 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 20:50:29,104 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 20:50:54,113 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 20:50:54,121 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 20:50:54,123 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:50:56,443 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:50:57,768 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 20:50:58,967 | INFO | genai_sql_agent | Executing SQL (start): SELECT school_id, (SUM(attendance) / COUNT(total_students)) * 100 AS attendance_percentage FROM attendance_data GROUP BY school_id
2025-10-29 20:50:58,969 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:50:59,656 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:51:00,916 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.
2025-10-29 20:51:01,114 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake object not found or not authorized. Original error: 002003 (42S02): SQL compilation error:
Object 'ATTENDANCE_DATA' does not exist or not authorized. Check spelling, database/schema context, or privileges for 'ATTENDANCE_DATA'. Similar existing tables: ATTENDANCE. Ensure DATABASE and SCHEMA env variables match target location.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 99, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x2af3793f1d0 state=finished raised RuntimeError>]
2025-10-29 20:53:03,462 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 20:53:03,472 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 20:53:03,563 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:53:04,950 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 20:53:28,193 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 20:53:28,198 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS PresentCount,         COUNT(*) AS TotalCount     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (PresentCount * 100.0 / TotalCount) 
2025-10-29 20:53:28,200 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:53:29,052 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 20:56:04,910 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:56:07,941 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 20:58:01,292 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 20:58:01,332 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 20:58:02,098 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:58:04,573 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 20:58:26,100 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 20:58:26,245 | INFO | genai_sql_agent | Executing SQL (start): SELECT S.SCHOOL_KEY,         COUNT(A.ATTENDANCE_KEY) * 100.0 / NULLIF(COUNT(DISTINCT E.ENROLLMENTS_KEY), 0) AS ATTENDANCE_PERCENTAGE FROM ATTENDANCE A JOIN STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY JOIN (SELECT STUDENT_KEY, COUNT(DISTINCT CALENDAR_DATE_KEY) AS ENROLLMENTS_KEY        FROM ATTENDANC
2025-10-29 20:58:26,260 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 20:58:27,901 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 21:01:43,899 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-29 21:01:43,927 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-29 21:01:45,183 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:01:47,654 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:01:48,724 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:01:51,193 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:02:08,182 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:02:08,193 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS PresentCount,         COUNT(*) AS TotalCount     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (PresentCount * 100.0 / TotalCount) 
2025-10-29 21:02:08,195 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:02:08,908 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 21:02:46,368 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:02:48,819 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:02:49,012 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:02:51,764 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:03:10,192 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:03:10,201 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS PresentCount,         COUNT(*) AS TotalCount     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (PresentCount * 100.0 / TotalCount) 
2025-10-29 21:03:10,202 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:03:10,947 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-29 21:04:33,751 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:04:36,377 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:04:56,895 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:04:56,906 | INFO | genai_sql_agent | Executing SQL (start): SELECT S.SCHOOL_KEY, S.STUDENT_GENDER, COUNT(*) AS STUDENT_COUNT  FROM STUDENTS S  GROUP BY S.SCHOOL_KEY, S.STUDENT_GENDER  ORDER BY S.SCHOOL_KEY, S.STUDENT_GENDER
2025-10-29 21:04:56,910 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:04:57,705 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-29 21:41:40,738 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:41:42,687 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:43:00,913 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:43:02,413 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:43:14,807 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:43:14,813 | INFO | genai_sql_agent | Executing SQL (start): WITH CourseMarks AS (     SELECT COURSE_KEY, AVG(MARKS) AS AVG_MARKS     FROM (         SELECT COURSE_KEY, STUDENT_MARKS_KEY, STUDENT_KEY, SCHOOL_YEAR_KEY, CALENDAR_DATE_KEY         FROM STUDENT_MARKS     ) AS Marks     JOIN (         SELECT STUDENT_KEY, STUDENT_EVOLVE_KEY, STUDENT_ANNUAL_ATTRIBS_KE
2025-10-29 21:43:14,813 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:43:15,474 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'
2025-10-29 21:43:16,685 | INFO | genai_sql_agent | Executing SQL (start): WITH CourseMarks AS (     SELECT COURSE_KEY, AVG(MARKS) AS AVG_MARKS     FROM (         SELECT COURSE_KEY, STUDENT_MARKS_KEY, STUDENT_KEY, SCHOOL_YEAR_KEY, CALENDAR_DATE_KEY         FROM STUDENT_MARKS     ) AS Marks     JOIN (         SELECT STUDENT_KEY, STUDENT_EVOLVE_KEY, STUDENT_ANNUAL_ATTRIBS_KE
2025-10-29 21:43:16,686 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:43:17,307 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'
2025-10-29 21:43:17,511 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 000904 (42000): SQL compilation error: error line 8 at position 28
invalid identifier 'STUDENT_EVOLVE_KEY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 91, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x2af3a4a87d0 state=finished raised RuntimeError>]
2025-10-29 21:44:30,543 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:44:31,968 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:44:43,029 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:44:43,036 | INFO | genai_sql_agent | Executing SQL (start): WITH CourseMarks AS (     SELECT COURSE_KEY, AVG(MARKS) AS AVERAGE_MARKS     FROM STUDENT_MARKS     GROUP BY COURSE_KEY ) SELECT COURSE_KEY, AVERAGE_MARKS FROM CourseMarks
2025-10-29 21:44:43,038 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:44:43,743 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'
2025-10-29 21:44:44,951 | INFO | genai_sql_agent | Executing SQL (start): WITH CourseMarks AS (     SELECT COURSE_KEY, AVG(MARKS) AS AVERAGE_MARKS     FROM STUDENT_MARKS     GROUP BY COURSE_KEY ) SELECT COURSE_KEY, AVERAGE_MARKS FROM CourseMarks
2025-10-29 21:44:44,952 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:44:45,587 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'
2025-10-29 21:44:45,810 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 000904 (42000): SQL compilation error: error line 2 at position 27
invalid identifier 'MARKS'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 91, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x2af1f1351d0 state=finished raised RuntimeError>]
2025-10-29 21:49:08,556 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:49:09,913 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-29 21:49:17,598 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:49:17,609 | INFO | genai_sql_agent | Executing SQL (start): SELECT STUDENT_RACE, COUNT(*) AS STUDENT_COUNT  FROM STUDENTS  GROUP BY STUDENT_RACE  ORDER BY STUDENT_COUNT DESC
2025-10-29 21:49:17,611 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:49:18,611 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-29 21:49:22,467 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-29 21:49:22,480 | INFO | genai_sql_agent | Executing SQL (start): SELECT STUDENT_RACE, COUNT(*) AS STUDENT_COUNT FROM STUDENTS GROUP BY STUDENT_RACE
2025-10-29 21:49:22,481 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-29 21:49:23,196 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 12:23:47,715 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:23:47,720 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:23:53,489 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:23:56,319 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:25:02,714 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 12:25:02,720 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceCounts AS (     SELECT SCHOOL_KEY,             COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS PresentCount,            COUNT(*) AS TotalCount     FROM ATTENDANCE     GROUP BY SCHOOL_KEY ) SELECT SCHOOL_KEY,         (PresentCount * 100.0 / TotalCount) AS AttendancePercentag
2025-10-30 12:25:02,721 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:25:03,536 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-30 12:35:24,890 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:35:24,900 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:35:25,011 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:35:27,067 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:36:59,924 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:36:59,931 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:42:02,577 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:42:04,612 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:43:50,153 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:43:50,157 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:43:54,503 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:43:56,881 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:44:19,717 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 12:44:19,723 | INFO | genai_sql_agent | Executing SQL (start): SELECT ABSENCE_REASON, COUNT(*) AS ABSENCE_COUNT  FROM ATTENDANCE  WHERE ABSENCE_REASON IS NOT NULL  GROUP BY ABSENCE_REASON
2025-10-30 12:44:19,724 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:44:20,544 | INFO | genai_sql_agent | Query executed; rows=2
2025-10-30 12:46:56,113 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:46:56,118 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:46:56,134 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:46:57,628 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:47:08,179 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 12:47:08,185 | INFO | genai_sql_agent | Executing SQL (start): SELECT ABSENCE_REASON, COUNT(*) AS ABSENCE_COUNT  FROM ATTENDANCE  WHERE ABSENCE_REASON IS NOT NULL  GROUP BY ABSENCE_REASON
2025-10-30 12:47:08,186 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:47:08,913 | INFO | genai_sql_agent | Query executed; rows=2
2025-10-30 12:49:14,026 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:49:14,029 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:49:17,225 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:49:19,019 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:49:33,061 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 12:49:33,065 | INFO | genai_sql_agent | Executing SQL (start): SELECT STUDENT_RACE, COUNT(*) AS STUDENT_COUNT FROM STUDENTS GROUP BY STUDENT_RACE
2025-10-30 12:49:33,067 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:49:33,823 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 12:58:20,015 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 12:58:20,022 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 12:58:26,158 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:58:28,722 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 12:59:08,322 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 12:59:08,326 | INFO | genai_sql_agent | Executing SQL (start): SELECT CALENDAR_DATE_KEY, COUNT(ATTENDANCE_KEY) AS ATTENDANCE_COUNT  FROM ATTENDANCE  GROUP BY CALENDAR_DATE_KEY  ORDER BY CALENDAR_DATE_KEY
2025-10-30 12:59:08,327 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 12:59:09,047 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-30 13:05:44,775 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:05:44,779 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain_openai', legacy_err=No module named 'langchain.llms')
2025-10-30 13:05:49,300 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:05:52,546 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:06:03,209 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:06:03,214 | INFO | genai_sql_agent | Executing SQL (start): SELECT S.SCHOOL_KEY, S.STUDENT_GENDER, COUNT(*) AS STUDENT_COUNT  FROM STUDENTS S  GROUP BY S.SCHOOL_KEY, S.STUDENT_GENDER  ORDER BY S.SCHOOL_KEY, S.STUDENT_GENDER
2025-10-30 13:06:03,215 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:06:03,956 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 13:07:46,723 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:07:46,727 | INFO | genai_sql_agent | Executing SQL (start): SELECT S.STUDENT_RACE, COUNT(A.ATTENDANCE_KEY) AS ATTENDANCE_COUNT, COUNT(M.STUDENT_MARKS_KEY) AS MARKS_COUNT FROM STUDENTS S LEFT JOIN ATTENDANCE A ON S.STUDENT_KEY = A.STUDENT_KEY LEFT JOIN STUDENT_MARKS M ON S.STUDENT_KEY = M.STUDENT_KEY GROUP BY S.STUDENT_RACE
2025-10-30 13:07:46,727 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:07:47,673 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 13:09:55,437 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:09:56,666 | WARNING | genai_sql_agent | LangChain not available or incompatible; using direct OpenAI prompts. (new_err=No module named 'langchain.callbacks', legacy_err=No module named 'langchain.llms')
2025-10-30 13:10:00,639 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:10:02,683 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:14:54,999 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:14:55,808 | WARNING | genai_sql_agent | LangChain modern imports unavailable; using direct OpenAI prompts. (err=No module named 'langchain.chains')
2025-10-30 13:14:58,168 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:15:00,105 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:15:11,629 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:15:18,115 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:15:18,119 | INFO | genai_sql_agent | Executing SQL (start): SELECT ABSENCE_REASON, COUNT(*) AS ABSENCE_COUNT  FROM ATTENDANCE  WHERE ABSENCE_REASON_CODE IS NOT NULL  GROUP BY ABSENCE_REASON
2025-10-30 13:15:18,121 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:15:18,897 | INFO | genai_sql_agent | Query executed; rows=2
2025-10-30 13:32:46,678 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:32:48,235 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 13:32:53,543 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:32:56,748 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:35:05,481 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:35:05,485 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,          S.STUDENT_GENDER,          COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT
2025-10-30 13:35:05,486 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:35:06,338 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 13:41:13,209 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:41:13,966 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 13:41:17,957 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:41:20,275 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:42:55,716 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:42:55,719 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceMarks AS (     SELECT          S.SCHOOL_TYPE,         AVG(A.ATTENDANCE_TYPE) AS AVG_ATTENDANCE,         AVG(M.STUDENT_MARKS_KEY) AS AVG_MARKS     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY     JOIN          STUDENT_MARKS M ON A.STUDENT_KEY
2025-10-30 13:42:55,720 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:42:56,359 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
2025-10-30 13:42:57,568 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceMarks AS (     SELECT          S.SCHOOL_TYPE,         AVG(A.ATTENDANCE_TYPE) AS AVG_ATTENDANCE,         AVG(M.STUDENT_MARKS_KEY) AS AVG_MARKS     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY     JOIN          STUDENT_MARKS M ON A.STUDENT_KEY
2025-10-30 13:42:57,569 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:42:58,150 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
2025-10-30 13:42:58,366 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 102, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1b6bf2e3b90 state=finished raised RuntimeError>]
2025-10-30 13:46:22,692 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:46:24,116 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:46:55,594 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:46:55,603 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceMarks AS (     SELECT          S.SCHOOL_TYPE,         AVG(A.ATTENDANCE_TYPE) AS AVG_ATTENDANCE,         AVG(M.STUDENT_MARKS_KEY) AS AVG_MARKS     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY     JOIN          STUDENT_MARKS M ON A.STUDENT_KEY
2025-10-30 13:46:55,604 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:46:56,374 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
2025-10-30 13:46:57,592 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceMarks AS (     SELECT          S.SCHOOL_TYPE,         AVG(A.ATTENDANCE_TYPE) AS AVG_ATTENDANCE,         AVG(M.STUDENT_MARKS_KEY) AS AVG_MARKS     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY     JOIN          STUDENT_MARKS M ON A.STUDENT_KEY
2025-10-30 13:46:57,593 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:46:58,251 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'
2025-10-30 13:46:58,460 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 000904 (42000): SQL compilation error: error line 3 at position 8
invalid identifier 'S.SCHOOL_TYPE'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 102, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1b6bf5f15d0 state=finished raised RuntimeError>]
2025-10-30 13:48:06,952 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:48:06,955 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT STUDENT_KEY, COUNT(*) AS AttendanceCount     FROM ATTENDANCE     WHERE ATTENDANCE_TYPE = 'Present'     GROUP BY STUDENT_KEY ), MarksSummary AS (     SELECT STUDENT_KEY, AVG(MARKS) AS AverageMarks     FROM STUDENT_MARKS     GROUP BY STUDENT_KEY ) SELECT a.STUDEN
2025-10-30 13:48:06,956 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:48:07,627 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'
2025-10-30 13:48:08,831 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT STUDENT_KEY, COUNT(*) AS AttendanceCount     FROM ATTENDANCE     WHERE ATTENDANCE_TYPE = 'Present'     GROUP BY STUDENT_KEY ), MarksSummary AS (     SELECT STUDENT_KEY, AVG(MARKS) AS AverageMarks     FROM STUDENT_MARKS     GROUP BY STUDENT_KEY ) SELECT a.STUDEN
2025-10-30 13:48:08,832 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:48:09,473 | ERROR | genai_sql_agent | Snowflake query failed: Snowflake programming error: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'
2025-10-30 13:48:09,679 | ERROR | genai_sql_agent | Execution error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 176, in run_query
    cs.execute(sql)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\cursor.py", line 1121, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\snowflake\connector\errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\snowflake_client.py", line 185, in run_query
    raise enhanced
RuntimeError: Snowflake programming error: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'MARKS'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 102, in <module>
    df = run_query(sql_clean)
         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\tenacity\__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1b6b9bba5d0 state=finished raised RuntimeError>]
2025-10-30 13:48:58,986 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:48:58,991 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT          STUDENT_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS Total_Present,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Absent' THEN 1 END) AS Total_Absent     FROM          ATTENDANCE     GROUP BY          STUDENT_KEY ) SELECT      S
2025-10-30 13:48:58,992 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:48:59,855 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-30 13:51:43,619 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 13:51:43,619 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 13:51:43,639 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:51:45,393 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 13:53:02,844 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 13:53:02,848 | INFO | genai_sql_agent | Executing SQL (start): SELECT S.SCHOOL_TYPE, AVG(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS AVG_ATTENDANCE_PRESENT FROM ATTENDANCE A JOIN SCHOOLS S ON A.SCHOOL_KEY = S.SCHOOL_KEY GROUP BY S.SCHOOL_TYPE
2025-10-30 13:53:02,849 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 13:53:03,784 | INFO | genai_sql_agent | Query executed; rows=2
2025-10-30 15:13:38,617 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:13:40,450 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 15:22:50,985 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:22:52,054 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:22:56,867 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:22:58,986 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 15:29:22,151 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:29:25,456 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:29:30,890 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:29:33,763 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 15:33:27,618 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:33:30,080 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:33:36,807 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:33:40,042 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 15:34:44,863 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:34:44,875 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:40:50,360 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:40:52,823 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:41:01,054 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:41:04,252 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 15:44:03,839 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 15:44:03,841 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 15:44:03,879 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 15:44:05,493 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 16:14:01,833 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 16:14:04,010 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 16:15:31,238 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 16:15:34,118 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 16:15:42,767 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 16:15:46,836 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 16:18:58,881 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 16:18:58,882 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 16:18:58,969 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 16:19:00,786 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 16:19:17,866 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 16:19:17,870 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceSummary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS PresentCount,         COUNT(*) AS TotalCount     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (PresentCount * 100.0 / TotalCount) 
2025-10-30 16:19:17,870 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 16:19:18,660 | INFO | genai_sql_agent | Query executed; rows=3
2025-10-30 16:24:18,160 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 16:24:18,171 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,          S.STUDENT_GENDER,          COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT
2025-10-30 16:24:18,172 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 16:24:19,323 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 16:26:49,320 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 16:26:49,321 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 18:02:15,169 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 18:02:15,173 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 18:02:15,403 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:02:20,021 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 18:02:28,988 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:02:30,467 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 18:08:42,706 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 18:08:42,707 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 18:08:50,330 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 18:08:50,343 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,          S.STUDENT_GENDER,          COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT
2025-10-30 18:08:50,347 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:08:51,273 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 18:09:51,881 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 18:09:54,272 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 18:09:59,744 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:10:02,677 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 18:10:18,490 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-30 18:10:18,495 | INFO | genai_sql_agent | Executing SQL (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,         S.STUDENT_GENDER,         COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_K
2025-10-30 18:10:18,496 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:10:19,591 | INFO | genai_sql_agent | Query executed; rows=4
2025-10-30 18:10:43,492 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,         S.STUDENT_GENDER,         COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_K
2025-10-30 18:10:43,492 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:10:44,376 | INFO | genai_sql_agent | Query executed; rows=4, time=0.133s
2025-10-30 18:10:44,595 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT      S.STUDENT_RACE,     S.STUDENT_GENDER,     (SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) * 100.0 / COUNT(A.ATTENDANCE_KEY)) AS AverageAttendancePercentage FROM      ATTENDANCE A JOIN      STUDENTS S ON A.STUDENT_KEY = S.STUDENT_KEY GROUP BY      S.STUDENT_RACE, S.STUDENT
2025-10-30 18:10:44,597 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:10:45,321 | INFO | genai_sql_agent | Query executed; rows=4, time=0.196s
2025-10-30 18:13:59,699 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 18:13:59,699 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 18:13:59,847 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:14:01,752 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 18:14:26,044 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,         S.STUDENT_GENDER,         COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_K
2025-10-30 18:14:26,045 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:14:26,877 | INFO | genai_sql_agent | Query executed; rows=4, time=0.133s
2025-10-30 18:14:27,114 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH AttendanceData AS (     SELECT          S.STUDENT_RACE,         S.STUDENT_GENDER,         COUNT(A.ATTENDANCE_KEY) AS TotalAttendance,         SUM(CASE WHEN A.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS PresentCount     FROM          ATTENDANCE A     JOIN          STUDENTS S ON A.STUDENT_K
2025-10-30 18:14:27,115 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:14:27,907 | INFO | genai_sql_agent | Query executed; rows=4, time=0.216s
2025-10-30 18:52:07,387 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:52:10,567 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 18:52:11,503 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 18:52:12,063 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:01:34,867 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 19:01:37,865 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 19:01:46,816 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:01:49,733 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:07:57,486 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:07:58,889 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:08:53,848 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-30 19:08:57,730 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-30 19:09:08,229 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:09:09,562 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:09:12,181 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:09:13,901 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:09:14,396 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:09:14,801 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:09:15,063 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:09:15,362 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-30 19:09:16,144 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-30 19:09:17,360 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:35:33,509 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 00:35:41,125 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 00:39:04,833 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 00:39:07,157 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 00:44:24,259 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:44:27,339 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:45:03,629 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:45:05,002 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:45:49,362 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-31 00:45:49,367 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT S.SCHOOL_KEY,         COUNT(A.ATTENDANCE_KEY) * 100.0 / NULLIF(COUNT(DISTINCT A.STUDENT_KEY), 0) AS ATTENDANCE_PERCENTAGE  FROM ATTENDANCE A  JOIN SCHOOLS S ON A.SCHOOL_KEY = S.SCHOOL_KEY  GROUP BY S.SCHOOL_KEY
2025-10-31 00:45:49,367 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:45:50,188 | INFO | genai_sql_agent | Query executed; rows=3, time=0.336s
2025-10-31 00:46:45,656 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT S.SCHOOL_KEY,         COUNT(A.ATTENDANCE_KEY) * 100.0 / NULLIF(COUNT(DISTINCT A.STUDENT_KEY), 0) AS ATTENDANCE_PERCENTAGE  FROM ATTENDANCE A  JOIN SCHOOLS S ON A.SCHOOL_KEY = S.SCHOOL_KEY  GROUP BY S.SCHOOL_KEY
2025-10-31 00:46:45,656 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:46:46,379 | INFO | genai_sql_agent | Query executed; rows=3, time=0.120s
2025-10-31 00:46:46,593 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT S.SCHOOL_KEY,         COUNT(A.ATTENDANCE_KEY) * 100.0 / NULLIF(NULLIF(COUNT(DISTINCT A.STUDENT_KEY), 0), 0) AS ATTENDANCE_PERCENTAGE  FROM ATTENDANCE A  JOIN SCHOOLS S ON A.SCHOOL_KEY = S.SCHOOL_KEY  GROUP BY S.SCHOOL_KEY
2025-10-31 00:46:46,595 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:46:47,297 | INFO | genai_sql_agent | Query executed; rows=3, time=0.216s
2025-10-31 00:53:37,759 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 00:53:37,760 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 00:53:37,793 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:53:39,185 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:58:01,913 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 00:58:01,914 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 00:58:01,943 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:58:03,264 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:58:08,108 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 00:58:09,420 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 00:59:20,099 | WARNING | genai_sql_agent | Responses API failed (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); attempting chat.completions fallback.
2025-10-31 00:59:24,023 | ERROR | genai_sql_agent | OpenAI SQL generation failed
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 122, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-10-31 00:59:24,030 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 204, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 122, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-10-31 00:59:24,033 | ERROR | genai_sql_agent | SQL generation error
Traceback (most recent call last):
  File "C:\Study\SQL_Generation_LLM\app.py", line 94, in <module>
    sql_raw = generate_sql(user_q, schema_text=combined_schema_hint, db_uri=None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 204, in generate_sql
    sql = generate_sql_openai(nl_query, schema_text=schema_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\langchain_agent.py", line 122, in generate_sql_openai
    comp = _openai_client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Study\SQL_Generation_LLM\.venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}
2025-10-31 01:02:19,824 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 01:02:19,826 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 01:02:19,853 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:02:21,381 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 01:02:43,233 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-10-31 01:02:49,103 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 01:02:54,801 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-10-31 01:02:54,802 | INFO | genai_sql_agent | Generated SQL via OpenAI prompt
2025-10-31 01:02:54,804 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH AttendanceData AS (     SELECT          SCHOOL_KEY,         COUNT(*) AS ATTENDANCE_COUNT     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ), MarksData AS (     SELECT          SCHOOL_KEY,         AVG(STUDENT_MARKS_KEY) AS AVERAGE_MARKS     FROM          STUDENT_MARKS     GROUP BY  
2025-10-31 01:02:54,804 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:02:55,548 | INFO | genai_sql_agent | Query executed; rows=2, time=0.309s
2025-10-31 01:03:28,466 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-10-31 01:03:32,990 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 01:03:52,724 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-10-31 01:03:57,327 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-10-31 01:04:07,297 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH AttendanceData AS (     SELECT          SCHOOL_KEY,         COUNT(*) AS ATTENDANCE_COUNT     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ), MarksData AS (     SELECT          SCHOOL_KEY,         AVG(STUDENT_MARKS_KEY) AS AVERAGE_MARKS     FROM          STUDENT_MARKS     GROUP BY  
2025-10-31 01:04:07,300 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:04:08,274 | INFO | genai_sql_agent | Query executed; rows=2, time=0.144s
2025-10-31 01:04:08,491 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT      S.SCHOOL_TYPE,     AVG(COALESCE(A.ATTENDANCE_COUNT, 0) + COALESCE(M.AVERAGE_MARKS, 0)) AS AVERAGE_ATTENDANCE_MARKS FROM      SCHOOLS S LEFT JOIN (     SELECT          SCHOOL_KEY,         COUNT(*) AS ATTENDANCE_COUNT     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) A ON S.S
2025-10-31 01:04:08,492 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:04:09,252 | INFO | genai_sql_agent | Query executed; rows=2, time=0.217s
2025-10-31 01:04:35,774 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-10-31 01:04:40,893 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 01:04:59,031 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-10-31 01:05:03,664 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-10-31 01:08:22,978 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 01:08:22,979 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 01:08:23,053 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:08:24,431 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 01:11:13,937 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 01:11:13,938 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 01:11:13,971 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:11:15,311 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 01:13:24,177 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 01:13:24,178 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 01:13:24,261 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 01:13:25,604 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:14:35,600 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:14:38,422 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:14:46,882 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:14:50,678 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:16:36,618 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:16:36,622 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:16:36,677 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:16:37,842 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:16:57,210 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:16:57,213 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:16:57,243 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:16:58,365 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:19:25,807 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:19:25,810 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:19:25,921 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:19:27,105 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:22:18,861 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:22:18,862 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:22:18,962 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:22:20,155 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:25:21,708 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:25:21,712 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:25:21,756 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:25:22,721 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:25:22,899 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:25:23,821 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:25:28,949 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:25:30,058 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:33:46,651 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:33:47,891 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:36:21,831 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:36:23,081 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:39:48,641 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:39:48,642 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:39:48,731 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:39:49,887 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:44:04,603 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-10-31 11:44:09,620 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 11:44:15,499 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-10-31 11:44:15,506 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          STUDENT_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS total_present,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Absent' THEN 1 END) AS total_absent,         SUM(CASE WHEN EXCUSED_ABSENCE = 'Yes' THEN 1 ELSE 0 END) AS excused_
2025-10-31 11:44:15,507 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:44:16,390 | INFO | genai_sql_agent | Query executed; rows=0, time=0.325s
2025-10-31 11:44:54,559 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-10-31 11:44:57,850 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 11:45:16,590 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-10-31 11:45:22,604 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-10-31 11:45:38,340 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          STUDENT_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS total_present,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Absent' THEN 1 END) AS total_absent,         SUM(CASE WHEN EXCUSED_ABSENCE = 'Yes' THEN 1 ELSE 0 END) AS excused_
2025-10-31 11:45:38,343 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:45:39,093 | INFO | genai_sql_agent | Query executed; rows=0, time=0.110s
2025-10-31 11:45:39,294 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT      s.STUDENT_KEY,     s.STUDENT_NAME,     COUNT(CASE WHEN a.ATTENDANCE_TYPE = 'Present' THEN 1 END) AS total_present,     COUNT(CASE WHEN a.ATTENDANCE_TYPE = 'Absent' THEN 1 END) AS total_absent,     SUM(CASE WHEN a.EXCUSED_ABSENCE = 'Yes' THEN 1 ELSE 0 END) AS excused_absences,     SUM(CAS
2025-10-31 11:45:39,296 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:45:39,943 | INFO | genai_sql_agent | Query executed; rows=0, time=0.262s
2025-10-31 11:47:02,582 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-10-31 11:47:07,515 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-10-31 11:47:28,656 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-10-31 11:47:35,139 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-10-31 11:50:35,407 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:50:35,407 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:50:35,475 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:50:36,699 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:54:51,007 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 11:54:51,027 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 11:54:52,375 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:54:56,515 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 11:56:25,932 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 11:56:27,313 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:13:00,197 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:13:00,199 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 12:13:00,336 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:13:01,934 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:15:17,451 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:15:17,456 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 12:15:17,828 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:15:19,879 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:16:09,952 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:16:09,955 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 12:16:10,319 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:16:11,980 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:50:27,370 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:50:30,859 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 12:50:54,441 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:51:03,357 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:54:27,282 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:54:28,536 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:54:39,040 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:54:40,339 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:55:31,817 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:55:31,821 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 12:55:31,879 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 12:55:33,000 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 12:56:14,367 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 12:56:14,369 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 13:01:43,527 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 13:01:43,534 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 13:01:43,709 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 13:01:45,455 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 13:04:12,500 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 13:04:12,509 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 13:04:17,524 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 13:04:18,776 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 13:06:26,262 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 13:06:26,306 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 13:06:29,178 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 13:06:30,522 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 14:54:01,099 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 14:54:03,860 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 14:54:09,574 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 14:54:11,345 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 14:54:15,621 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 14:54:17,067 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 14:54:29,022 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 14:54:30,177 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:14:14,763 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:14:16,381 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:21:03,054 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:21:03,056 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:21:05,469 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:21:06,761 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:21:25,880 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:21:27,050 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:29:25,073 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:29:26,393 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:29:52,814 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:29:54,144 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:32:54,964 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:32:54,964 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:32:55,478 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:32:56,623 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:35:28,254 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:35:28,255 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:35:28,925 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:35:30,122 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:36:42,057 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:36:42,058 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:37:24,175 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:37:25,354 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:41:40,372 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:41:43,083 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:42:01,142 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:42:02,212 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:42:09,857 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:42:12,637 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:45:26,959 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:45:26,960 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:45:27,573 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:45:28,764 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:54:22,658 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:54:22,658 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:54:24,595 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:54:26,065 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 16:57:21,672 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 16:57:21,673 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 16:57:23,496 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 16:57:24,760 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 17:02:04,922 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 17:02:04,923 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 17:02:04,942 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 17:02:06,151 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 17:03:16,634 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 17:03:16,634 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 17:03:16,672 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 17:03:17,836 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-10-31 17:11:02,275 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-10-31 17:11:02,276 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-10-31 17:11:04,155 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-10-31 17:11:05,366 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 13:11:56,002 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 13:11:57,146 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 13:12:06,220 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 13:12:09,155 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 14:31:05,845 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 14:31:07,523 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 14:31:31,415 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 14:31:34,812 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 14:40:58,224 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 14:40:58,225 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 14:40:58,324 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 14:40:59,862 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 14:44:59,021 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 14:44:59,027 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 14:44:59,133 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 14:45:00,675 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 15:18:46,724 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 15:18:49,453 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 15:19:25,493 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 15:19:28,814 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 15:19:33,141 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 15:19:34,714 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 16:15:19,165 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 16:15:21,112 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 19:17:09,816 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 19:17:12,391 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 19:17:34,686 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 19:17:38,090 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 19:25:20,166 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 19:25:20,172 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 19:25:44,766 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 19:25:44,767 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 19:25:57,411 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 19:25:57,412 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:15:56,991 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:15:59,170 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:16:23,751 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-11-03 22:16:28,341 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-03 22:16:35,068 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-11-03 22:16:35,079 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          s.STUDENT_RACE,         s.STUDENT_GENDER,         COUNT(CASE WHEN a.ATTENDANCE_TYPE = 'Present' THEN 1 END) AS present_count,         COUNT(*) AS total_count     FROM          ATTENDANCE a     JOIN          STUDENTS s ON a.STUDENT_KEY = s.STUDENT_KEY 
2025-11-03 22:16:35,080 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:16:36,024 | INFO | genai_sql_agent | Query executed; rows=4, time=0.394s
2025-11-03 22:16:45,192 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-11-03 22:16:48,691 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-03 22:16:53,622 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-11-03 22:16:53,631 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          s.STUDENT_RACE,         s.STUDENT_GENDER,         COUNT(a.ATTENDANCE_KEY) AS total_days,         SUM(CASE WHEN a.ATTENDANCE_TYPE = 'Present' THEN 1 ELSE 0 END) AS present_days     FROM          ATTENDANCE a     JOIN          STUDENTS s ON a.STUDENT_KE
2025-11-03 22:16:53,633 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:16:54,352 | INFO | genai_sql_agent | Query executed; rows=4, time=0.188s
2025-11-03 22:25:53,617 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:25:53,625 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:25:53,738 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:25:55,635 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:29:18,441 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:29:18,441 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:29:22,132 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:29:23,572 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:29:49,697 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:29:51,061 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:35:03,829 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:35:03,830 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:38:03,039 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:38:03,040 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:38:14,903 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:38:16,262 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:38:42,025 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:38:43,500 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:39:08,502 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:39:09,850 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:40:55,763 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-11-03 22:41:01,946 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-03 22:41:05,103 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-11-03 22:41:05,119 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS present_count,         COUNT(*) AS total_count     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (present_count::FLOAT / total_cou
2025-11-03 22:41:05,121 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:41:05,842 | INFO | genai_sql_agent | Query executed; rows=3, time=0.186s
2025-11-03 22:43:02,032 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:43:03,327 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:46:21,070 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:46:21,081 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:52:23,945 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:52:23,951 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:52:24,036 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:52:25,808 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:53:11,382 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:53:12,775 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:53:53,477 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 22:53:53,478 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 22:53:59,417 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:54:00,736 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:54:17,172 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:54:18,522 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-03 22:56:21,759 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-11-03 22:56:28,935 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-03 22:56:32,286 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-11-03 22:56:32,292 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH attendance_summary AS (     SELECT          SCHOOL_KEY,         COUNT(CASE WHEN ATTENDANCE_TYPE = 'Present' THEN 1 END) AS present_count,         COUNT(*) AS total_count     FROM          ATTENDANCE     GROUP BY          SCHOOL_KEY ) SELECT      SCHOOL_KEY,     (present_count::FLOAT / total_cou
2025-11-03 22:56:32,293 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 22:56:33,237 | INFO | genai_sql_agent | Query executed; rows=3, time=0.144s
2025-11-03 22:57:21,407 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-11-03 22:57:27,458 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-03 22:57:47,720 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-11-03 22:57:49,959 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-11-03 23:06:11,098 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-03 23:06:11,099 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-03 23:06:11,128 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-03 23:06:12,815 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 12:26:08,465 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 12:26:10,525 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 12:26:40,809 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 12:26:44,149 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 12:30:22,954 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 12:30:22,956 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 12:30:27,890 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 12:30:29,345 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 12:31:25,642 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 12:31:26,266 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 12:32:27,563 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 12:32:29,445 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 12:32:51,703 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 12:32:51,704 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 12:33:09,708 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 12:33:10,260 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 12:33:16,814 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 12:33:18,760 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 13:18:55,191 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 13:18:55,194 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 13:19:04,037 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 13:19:07,358 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 13:31:56,744 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 13:31:58,579 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 13:34:57,977 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 13:34:59,532 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 16:59:34,849 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 16:59:36,818 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 16:59:47,608 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 16:59:51,250 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 17:01:55,328 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 17:01:55,365 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 17:02:02,180 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 17:02:03,642 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-04 17:36:38,569 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-04 17:36:38,571 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-04 17:36:52,316 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-04 17:36:54,517 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-05 13:41:16,375 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-05 13:41:19,891 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-05 13:42:45,114 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-05 13:42:49,261 | INFO | genai_sql_agent | Schema overview built; tables=4
2025-11-05 13:43:07,929 | WARNING | genai_sql_agent | Temperature unsupported model=gpt-5; retrying without temperature.
2025-11-05 13:43:14,358 | WARNING | genai_sql_agent | Quota/rate issue after retry model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-05 13:43:18,943 | INFO | genai_sql_agent | Generated SQL via Responses API model=gpt-4o-mini
2025-11-05 13:43:18,946 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH gender_distribution AS (     SELECT          s.SCHOOL_KEY,         s.STUDENT_GENDER,         COUNT(*) AS student_count     FROM          STUDENTS s     GROUP BY          s.SCHOOL_KEY, s.STUDENT_GENDER ) SELECT      sd.SCHOOL_KEY,     sd.STUDENT_GENDER,     sd.student_count,     ROUND(sd.student
2025-11-05 13:43:18,947 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-05 13:43:19,865 | INFO | genai_sql_agent | Query executed; rows=4, time=0.382s
2025-11-05 13:45:05,127 | WARNING | genai_sql_agent | Temperature unsupported for model=gpt-5 (Error code: 400 - {'error': {'message': "Unsupported parameter: 'temperature' is not supported with this model.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': None}}); retry without temperature.
2025-11-05 13:45:11,043 | WARNING | genai_sql_agent | Retry without temperature failed model=gpt-5 (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}})
2025-11-05 13:45:29,325 | WARNING | genai_sql_agent | Quota/Rate issue optimization model=gpt-4o (Error code: 429 - {'error': {'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, read the docs: https://platform.openai.com/docs/guides/error-codes/api-errors.', 'type': 'insufficient_quota', 'param': None, 'code': 'insufficient_quota'}}); trying next.
2025-11-05 13:45:32,299 | INFO | genai_sql_agent | Optimization via Responses API model=gpt-4o-mini
2025-11-05 13:45:57,302 | INFO | genai_sql_agent | Executing SQL with timing (start): WITH gender_distribution AS (     SELECT          s.SCHOOL_KEY,         s.STUDENT_GENDER,         COUNT(*) AS student_count     FROM          STUDENTS s     GROUP BY          s.SCHOOL_KEY, s.STUDENT_GENDER ) SELECT      sd.SCHOOL_KEY,     sd.STUDENT_GENDER,     sd.student_count,     ROUND(sd.student
2025-11-05 13:45:57,309 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-05 13:45:59,354 | INFO | genai_sql_agent | Query executed; rows=4, time=0.175s
2025-11-05 13:45:59,816 | INFO | genai_sql_agent | Executing SQL with timing (start): SELECT      s.SCHOOL_KEY,     s.STUDENT_GENDER,     COUNT(*) AS student_count,     ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY s.SCHOOL_KEY), 2) AS gender_percentage FROM      STUDENTS s GROUP BY      s.SCHOOL_KEY, s.STUDENT_GENDER ORDER BY      s.SCHOOL_KEY, s.STUDENT_GENDER
2025-11-05 13:45:59,818 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-05 13:46:00,910 | INFO | genai_sql_agent | Query executed; rows=4, time=0.214s
2025-11-05 15:46:41,426 | INFO | genai_sql_agent | Initialized new OpenAI client (version 2.6.1)
2025-11-05 15:46:44,263 | INFO | genai_sql_agent | LangChain components available (langchain_openai + langchain_community); will use for db_uri SQL generation
2025-11-05 15:46:57,838 | INFO | genai_sql_agent | Opening Snowflake connection user=ROHITH0707 db=ANALYTICS schema=PUBLIC
2025-11-05 15:47:03,553 | INFO | genai_sql_agent | Schema overview built; tables=4
